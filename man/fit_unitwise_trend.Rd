% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_unitwise_trend.R
\name{fit_unitwise_trend}
\alias{fit_unitwise_trend}
\title{Fit Unit-Specific Polynomial Trend with Unitwise Coefficients}
\usage{
fit_unitwise_trend(
  data,
  unit,
  degree,
  unit_var,
  time_var,
  outcome_var,
  treat_time_var,
  hh,
  covariate_vars = NULL,
  beta_hat = NULL,
  forecast_lag = 0,
  pretreatment_window = c("full", "minimal")
)
}
\arguments{
\item{data}{The full dataset (data frame).}

\item{unit}{A single unit (e.g. state or municipality) to subset on.}

\item{degree}{Degree of the polynomial (e.g. 0, 1, 2).}

\item{unit_var}{Name of the unit identifier variable (string).}

\item{time_var}{Name of the time variable (string).}

\item{outcome_var}{Name of the outcome variable to predict (string).}

\item{treat_time_var}{Name of the treatment time variable (string).}

\item{covariate_vars}{Optional character vector of covariate names.}

\item{beta_hat}{Optional named vector of pooled covariate coefficients.}

\item{forecast_lag}{Number of periods to wait after treatment before forecasting begins.
Default is 0 (forecast starts in treatment year).}

\item{pretreatment_window}{Character. Either:
"full" = use all pre-treatment observations; or
"minimal" = use exactly degree+1+p most recent pre-treatment periods,
where p = length(covariate_vars). Ensures just-identified unitwise fit.}
}
\value{
A data frame with unit, time, outcome, predicted values (\code{preds}),
and treatment time.
}
\description{
This function estimates a polynomial trend for a single unit, adjusting for
time-varying covariates with \strong{unit-specific} coefficients (βᵢ).
For each unit, it fits the model:
\deqn{ y_{it} = \sum_{k=0}^{q} c_k (t - t_0)^k + x_{it}' βᵢ + ε_{it} }
where the coefficients \eqn{βᵢ} are estimated from pre-treatment data only.

This approach allows for heterogeneous covariate effects across units.
}
