---
title: "Forecasted Average Treatment Effects in the Absence of a Control Group"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Forecasted Average Treatment Effects}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

The `fatEstimator` package implements the methodology of Botosaru, Giacomini, and Weidner (2023), designed for settings where no valid control group exists. This includes nationwide reforms, universal policy shifts, and endogenous adoption, where traditional treatment-control comparisons fail.

# Theoretical Background

In standard treatment effect estimation, control groups are essential to infer counterfactual outcomes. However, many important policies (e.g., universal participation policies, fiscal shocks, large-scale mandates) lack such a group. Botosaru et al. (2023) propose the Forecasted Average Treatment Effect (FAT) estimator, which addresses this by forecasting the untreated potential outcome using the individualâ€™s own pre-treatment history.

## Assumptions and Key Features

- **Forecast Unbiasedness**: Counterfactual forecasts must be unbiased on average.
- **Weak Dependence**: Forecast errors must satisfy a central limit theorem.
- **Basis Function Forecasting**: Forecasts are based on regressions using simple basis functions (e.g., polynomials).
- **Short Panel**: Identification and inference do not require long time series. 

## Advantages

- No control group needed.
- Allows for heterogeneous treatment effects.
- Robust to model misspecification.
- Compatible with short time series.

## Estimation Workflow

Each estimation follows three steps:

1. Fit pre-treatment model for each unit. 
2. Forecast outcomes at $T*_i + h$
3. Compare the forecasted and actual outcomes. 


## Model Specifications and Commands.

1. Baseline (no covariates):

$$
FAT(h) = \frac{1}{|\mathcal{I}|} \sum_{i \in \mathcal{I}} \left( Y_{i,T_i^* + h} - \hat{Y}_{i,T_i^* + h}^{(0)} \right)
$$

2. Covariates 


2. Heterogeneous Trends


3. Difference-in-FAt

Motivation: External shocks may affect all units post-treatment. DFAT compares treated vs. untreated forecasts. 

Parameter: 

```{r }

```



# Package Usage

```{r library}
#library(fatEstimation)
```

# Simulated Example

This example demonstrates how to use the package on simulated data:

```{r example}

```

# Interpretation

The function `fat_estimate()` uses a simple polynomial regression on pre-treatment data to forecast the counterfactual outcome. The ATT is then estimated as the average difference between the observed and forecasted outcomes in the post-treatment period.

# References

Botosaru, I., Giacomini, R., & Weidner, M. (2023). *Forecasted Treatment Effects*. Working Paper. Available from authors.
